<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ü–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è - –ê—Å—Ç–∞–Ω–∞</title>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700;900&family=Onest:wght@300;400;500&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --bg: #0d0d0d; --card: #161616; --accent: #c8f542; --accent2: #42f5c8;
  --text: #f0f0f0; --muted: #666; --border: #2a2a2a;
}
body { background: var(--bg); color: var(--text); font-family: 'Onest', sans-serif; min-height: 100vh; padding: 24px 16px 80px; overflow-x: hidden; }
.grain { position: fixed; inset: 0; pointer-events: none; z-index: 100; opacity: 0.03; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E"); }
.container { max-width: 720px; margin: 0 auto; }

/* SETUP SCREEN */
#setup-screen { animation: fadeUp 0.6s ease both; }
#main-screen { display: none; }

.setup-hero { margin-bottom: 40px; }
.tag { display: inline-block; background: var(--accent); color: #000; font-family: 'Unbounded', sans-serif; font-size: 10px; font-weight: 700; letter-spacing: 0.15em; padding: 4px 10px; border-radius: 2px; margin-bottom: 16px; text-transform: uppercase; }
h1 { font-family: 'Unbounded', sans-serif; font-size: clamp(26px, 6vw, 48px); font-weight: 900; line-height: 1.1; letter-spacing: -0.02em; }
h1 span { color: var(--accent); }
.subtitle { color: var(--muted); margin-top: 10px; font-size: 14px; }

.setup-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 28px; margin-bottom: 20px; }
.setup-title { font-family: 'Unbounded', sans-serif; font-size: 13px; font-weight: 700; margin-bottom: 20px; color: var(--accent); letter-spacing: 0.05em; }

.input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
.input-grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px; }

.input-group { display: flex; flex-direction: column; gap: 6px; }
.input-group.full { grid-column: 1 / -1; }

.input-label { font-size: 12px; color: var(--muted); font-weight: 500; }

.input-field {
  background: #111; border: 1px solid var(--border); border-radius: 10px;
  color: var(--text); font-family: 'Onest', sans-serif; font-size: 16px;
  padding: 12px 14px; width: 100%; outline: none; transition: border-color 0.2s;
}
.input-field:focus { border-color: var(--accent); }

select.input-field { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 8L1 3h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 14px center; }

/* Live preview */
.preview-box {
  background: rgba(200,245,66,0.06); border: 1px solid rgba(200,245,66,0.15);
  border-radius: 12px; padding: 18px; margin-top: 20px;
}
.preview-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
.preview-item { text-align: center; }
.preview-val { font-family: 'Unbounded', sans-serif; font-size: 18px; font-weight: 700; color: var(--accent); }
.preview-label { font-size: 11px; color: var(--muted); margin-top: 3px; }

.btn-start {
  width: 100%; background: var(--accent); color: #000; border: none;
  border-radius: 12px; font-family: 'Unbounded', sans-serif; font-size: 14px;
  font-weight: 900; padding: 16px; cursor: pointer; margin-top: 20px;
  transition: opacity 0.2s; letter-spacing: 0.05em;
}
.btn-start:hover { opacity: 0.85; }

/* MAIN */
.top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
.top-bar h2 { font-family: 'Unbounded', sans-serif; font-size: clamp(20px, 4vw, 32px); font-weight: 900; line-height: 1.2; }
.top-bar h2 span { color: var(--accent); }
.edit-btn { font-size: 12px; color: var(--muted); background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 8px 14px; cursor: pointer; font-family: 'Onest', sans-serif; transition: all 0.2s; white-space: nowrap; }
.edit-btn:hover { border-color: var(--accent); color: var(--text); }

.tabs { display: flex; gap: 8px; margin-bottom: 28px; flex-wrap: wrap; }
.tab { font-family: 'Unbounded', sans-serif; font-size: 11px; font-weight: 700; padding: 8px 14px; border-radius: 100px; border: 1px solid var(--border); background: transparent; color: var(--muted); cursor: pointer; transition: all 0.2s; }
.tab:hover { border-color: var(--accent); color: var(--text); }
.tab.active { background: var(--accent); color: #000; border-color: var(--accent); }
.tab-content { display: none; }
.tab-content.active { display: block; }

.stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 24px; }
.stat { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 16px; text-align: center; }
.stat-val { font-family: 'Unbounded', sans-serif; font-size: 20px; font-weight: 700; color: var(--accent); }
.stat-label { font-size: 11px; color: var(--muted); margin-top: 4px; }

.progress-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 24px; }
.progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
.progress-title { font-family: 'Unbounded', sans-serif; font-size: 13px; font-weight: 700; }
.progress-text { font-size: 13px; color: var(--muted); }
.bar-track { background: #222; border-radius: 100px; height: 10px; overflow: hidden; }
.bar-fill { height: 100%; border-radius: 100px; background: linear-gradient(90deg, var(--accent2), var(--accent)); width: 0%; transition: width 1.2s cubic-bezier(0.16, 1, 0.3, 1); }
.milestones { display: flex; justify-content: space-between; margin-top: 10px; font-size: 11px; color: var(--muted); }

.weight-input-row { display: flex; gap: 10px; margin-top: 16px; }
.weight-input-row input { background: #111; border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-family: 'Onest', sans-serif; font-size: 16px; padding: 10px 14px; width: 100%; outline: none; transition: border-color 0.2s; }
.weight-input-row input:focus { border-color: var(--accent); }
.btn { background: var(--accent); color: #000; border: none; border-radius: 8px; font-family: 'Unbounded', sans-serif; font-size: 12px; font-weight: 700; padding: 10px 16px; cursor: pointer; white-space: nowrap; transition: opacity 0.2s; }
.btn:hover { opacity: 0.85; }

.section { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 20px; }
.section-header { display: flex; align-items: center; gap: 10px; margin-bottom: 18px; }
.section-icon { width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 18px; flex-shrink: 0; }
.green-bg { background: rgba(200,245,66,0.12); }
.teal-bg  { background: rgba(66,245,200,0.12); }
.red-bg   { background: rgba(245,100,66,0.12); }
.section-title { font-family: 'Unbounded', sans-serif; font-size: 14px; font-weight: 700; }

.checklist { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.checklist li { display: flex; align-items: flex-start; gap: 12px; font-size: 14px; line-height: 1.5; cursor: pointer; padding: 10px 12px; border-radius: 8px; border: 1px solid transparent; transition: all 0.2s; user-select: none; }
.checklist li:hover { background: #1e1e1e; border-color: var(--border); }
.checklist li.done { opacity: 0.4; }
.checklist li.done .check-circle { background: var(--accent); border-color: var(--accent); }
.checklist li.done .check-circle::after { opacity: 1; }
.check-circle { width: 20px; height: 20px; border: 2px solid var(--border); border-radius: 50%; flex-shrink: 0; margin-top: 1px; position: relative; transition: all 0.2s; }
.check-circle::after { content: '‚úì'; position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; font-size: 11px; color: #000; font-weight: 700; opacity: 0; transition: opacity 0.2s; }

.timeline { display: flex; flex-direction: column; }
.tl-item { display: flex; gap: 16px; padding-bottom: 20px; position: relative; }
.tl-item:last-child { padding-bottom: 0; }
.tl-dot { width: 12px; height: 12px; border-radius: 50%; background: var(--border); flex-shrink: 0; margin-top: 4px; position: relative; z-index: 1; }
.tl-item:not(:last-child) .tl-dot::after { content: ''; position: absolute; left: 50%; top: 12px; transform: translateX(-50%); width: 1px; height: calc(100% + 20px); background: var(--border); }
.tl-dot.active { background: var(--accent); }
.tl-dot.active::after { background: linear-gradient(var(--accent), var(--border)); }
.tl-month { font-size: 11px; color: var(--muted); margin-bottom: 2px; }
.tl-goal { font-size: 14px; font-weight: 500; }
.tl-note { font-size: 12px; color: var(--muted); margin-top: 2px; }

.macro-row { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
.macro-pill { flex: 1; min-width: 70px; background: #111; border-radius: 10px; padding: 12px; text-align: center; }
.macro-val { font-family: 'Unbounded', sans-serif; font-size: 15px; font-weight: 700; }
.macro-label { font-size: 11px; color: var(--muted); margin-top: 3px; }
.c-protein { color: var(--accent); } .c-carbs { color: var(--accent2); } .c-fat { color: #f5a442; }

.budget-banner { background: rgba(200,245,66,0.08); border: 1px solid rgba(200,245,66,0.2); border-radius: 12px; padding: 14px 16px; margin-bottom: 20px; display: flex; align-items: center; gap: 12px; font-size: 13px; color: var(--accent); }
.budget-banner strong { font-family: 'Unbounded', sans-serif; font-size: 15px; }

.day-selector { display: flex; gap: 6px; margin-bottom: 20px; flex-wrap: wrap; }
.day-btn { font-family: 'Unbounded', sans-serif; font-size: 10px; font-weight: 700; padding: 6px 12px; border-radius: 100px; border: 1px solid var(--border); background: transparent; color: var(--muted); cursor: pointer; transition: all 0.2s; }
.day-btn:hover { border-color: var(--accent2); color: var(--text); }
.day-btn.active { background: var(--accent2); color: #000; border-color: var(--accent2); }

.meal-card { border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 12px; }
.meal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.meal-name { font-family: 'Unbounded', sans-serif; font-size: 11px; font-weight: 700; color: var(--muted); letter-spacing: 0.1em; text-transform: uppercase; }
.meal-kcal { font-family: 'Unbounded', sans-serif; font-size: 12px; color: var(--accent); }
.meal-items { display: flex; flex-direction: column; gap: 6px; }
.meal-item { display: flex; justify-content: space-between; font-size: 14px; padding: 6px 0; border-bottom: 1px solid #1e1e1e; }
.meal-item:last-child { border-bottom: none; }
.meal-item-grams { color: var(--muted); font-size: 13px; }

.daily-total { background: rgba(200,245,66,0.08); border: 1px solid rgba(200,245,66,0.2); border-radius: 10px; padding: 14px 16px; display: flex; justify-content: space-between; align-items: center; margin-top: 4px; }
.daily-total-label { font-size: 13px; color: var(--muted); }
.daily-total-val { font-family: 'Unbounded', sans-serif; font-size: 16px; color: var(--accent); }
.daily-cost { background: rgba(66,245,200,0.06); border: 1px solid rgba(66,245,200,0.15); border-radius: 10px; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }
.daily-cost-label { font-size: 13px; color: var(--muted); }
.daily-cost-val { font-family: 'Unbounded', sans-serif; font-size: 15px; color: var(--accent2); }

.grocery-section { margin-bottom: 20px; }
.grocery-title { font-family: 'Unbounded', sans-serif; font-size: 12px; color: var(--muted); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 10px; }
.grocery-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; border-radius: 8px; background: #111; margin-bottom: 6px; font-size: 14px; }
.grocery-price { font-family: 'Unbounded', sans-serif; font-size: 12px; color: var(--accent2); }
.grocery-total { background: rgba(66,245,200,0.08); border: 1px solid rgba(66,245,200,0.2); border-radius: 10px; padding: 14px 16px; display: flex; justify-content: space-between; align-items: center; margin-top: 8px; }

.workout-day { border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 12px; }
.workout-day-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
.workout-day-name { font-family: 'Unbounded', sans-serif; font-size: 13px; font-weight: 700; }
.workout-badge { font-size: 11px; padding: 3px 10px; border-radius: 100px; font-weight: 500; }
.badge-strength { background: rgba(200,245,66,0.15); color: var(--accent); }
.badge-cardio   { background: rgba(66,245,200,0.15); color: var(--accent2); }
.badge-rest     { background: rgba(255,255,255,0.06); color: var(--muted); }
.exercise-list { display: flex; flex-direction: column; gap: 8px; }
.exercise { display: flex; justify-content: space-between; align-items: center; font-size: 14px; padding: 8px 10px; border-radius: 8px; background: #111; cursor: pointer; user-select: none; transition: background 0.2s; }
.exercise:hover { background: #1a1a1a; }
.exercise.done-ex { opacity: 0.4; }
.ex-sets { font-size: 12px; color: var(--muted); font-family: 'Unbounded', sans-serif; }
.rest-day { text-align: center; padding: 24px; color: var(--muted); font-size: 14px; }
.rest-day span { display: block; font-size: 32px; margin-bottom: 8px; }

.bmi-badge { display: inline-block; padding: 4px 12px; border-radius: 100px; font-size: 12px; font-weight: 700; margin-top: 6px; }
.bmi-normal { background: rgba(200,245,66,0.15); color: var(--accent); }
.bmi-over   { background: rgba(245,160,66,0.15); color: #f5a042; }
.bmi-obese  { background: rgba(245,80,66,0.15); color: #f55042; }

@keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="grain"></div>
<div class="container">

<!-- ========== SETUP SCREEN ========== -->
<div id="setup-screen">
  <div class="setup-hero">
    <div class="tag">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∞</div>
    <h1>–í–≤–µ–¥–∏ —Å–≤–æ–∏<br><span>–ø–∞—Ä–∞–º–µ—Ç—Ä—ã</span></h1>
    <p class="subtitle">–°–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ —Ä–∞—Å—Å—á–∏—Ç–∞–µ—Ç –∫–∞–ª–æ—Ä–∏–∏, –ë–ñ–£ –∏ –ø–ª–∞–Ω</p>
  </div>

  <div class="setup-card">
    <div class="setup-title">üë§ –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
    <div class="input-grid">
      <div class="input-group">
        <div class="input-label">–ü–æ–ª</div>
        <select class="input-field" id="s-gender" onchange="calcPreview()">
          <option value="m">–ú—É–∂—Å–∫–æ–π</option>
          <option value="f">–ñ–µ–Ω—Å–∫–∏–π</option>
        </select>
      </div>
      <div class="input-group">
        <div class="input-label">–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç)</div>
        <input class="input-field" type="number" id="s-age" placeholder="30" min="15" max="80" value="28" oninput="calcPreview()">
      </div>
      <div class="input-group">
        <div class="input-label">–†–æ—Å—Ç (—Å–º)</div>
        <input class="input-field" type="number" id="s-height" placeholder="180" min="140" max="220" value="180" oninput="calcPreview()">
      </div>
      <div class="input-group">
        <div class="input-label">–¢–µ–∫—É—â–∏–π –≤–µ—Å (–∫–≥)</div>
        <input class="input-field" type="number" id="s-weight" placeholder="94" min="40" max="250" step="0.1" value="94" oninput="calcPreview()">
      </div>
      <div class="input-group">
        <div class="input-label">–ñ–µ–ª–∞–µ–º—ã–π –≤–µ—Å (–∫–≥)</div>
        <input class="input-field" type="number" id="s-target" placeholder="77" min="40" max="250" step="0.1" value="77" oninput="calcPreview()">
      </div>
      <div class="input-group">
        <div class="input-label">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</div>
        <select class="input-field" id="s-activity" onchange="calcPreview()">
          <option value="1.2" selected>–°–∏–¥—è—á–∏–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏</option>
          <option value="1.375">–õ—ë–≥–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (1‚Äì2 —Ä–∞–∑–∞/–Ω–µ–¥)</option>
          <option value="1.55">–°—Ä–µ–¥–Ω—è—è (3‚Äì4 —Ä–∞–∑–∞/–Ω–µ–¥)</option>
          <option value="1.725">–í—ã—Å–æ–∫–∞—è (5‚Äì6 —Ä–∞–∑/–Ω–µ–¥)</option>
        </select>
      </div>
    </div>

    <div class="preview-box">
      <div style="font-size:12px; color:var(--muted); margin-bottom:14px; font-family:'Unbounded',sans-serif; font-size:11px; letter-spacing:0.1em; text-transform:uppercase;">–¢–≤–æ–∏ —Ä–∞—Å—á—ë—Ç—ã</div>
      <div class="preview-grid">
        <div class="preview-item"><div class="preview-val" id="p-bmi">‚Äî</div><div class="preview-label">–ò–ú–¢</div></div>
        <div class="preview-item"><div class="preview-val" id="p-diff">‚Äî</div><div class="preview-label" id="p-diff-label">–°–±—Ä–æ—Å–∏—Ç—å –∫–≥</div></div>
        <div class="preview-item"><div class="preview-val" id="p-kcal">‚Äî</div><div class="preview-label">–∫–∫–∞–ª/–¥–µ–Ω—å</div></div>
        <div class="preview-item"><div class="preview-val" id="p-months">‚Äî</div><div class="preview-label">–ú–µ—Å—è—Ü–µ–≤</div></div>
        <div class="preview-item"><div class="preview-val" id="p-protein">‚Äî</div><div class="preview-label">–ë–µ–ª–æ–∫ –≥/–¥–µ–Ω—å</div></div>
        <div class="preview-item"><div class="preview-val" id="p-tdee">‚Äî</div><div class="preview-label">–í–∞—à TDEE</div></div>
      </div>
    </div>

    <button class="btn-start" onclick="startPlan()">üöÄ –°–æ–∑–¥–∞—Ç—å –º–æ–π –ø–ª–∞–Ω</button>
  </div>
</div>

<!-- ========== MAIN SCREEN ========== -->
<div id="main-screen">
  <div class="top-bar">
    <h2 id="main-title">–ú–∏–Ω—É—Å <span id="t-diff">‚Äî</span> –∫–≥</h2>
    <button class="edit-btn" onclick="goBack()">‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</button>
  </div>

  <div class="tabs">
    <button class="tab active" onclick="switchTab('tracker')">üìä –¢—Ä–µ–∫–µ—Ä</button>
    <button class="tab" onclick="switchTab('food')">ü•ó –ü–∏—Ç–∞–Ω–∏–µ</button>
    <button class="tab" onclick="switchTab('grocery')">üõí –ü–æ–∫—É–ø–∫–∏</button>
    <button class="tab" onclick="switchTab('workout')">üí™ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</button>
    <button class="tab" onclick="switchTab('rules')">üìã –ü—Ä–∞–≤–∏–ª–∞</button>
  </div>

  <!-- TRACKER -->
  <div id="tab-tracker" class="tab-content active">
    <div class="stats">
      <div class="stat"><div class="stat-val" id="t-current">‚Äî</div><div class="stat-label">–°–µ–π—á–∞—Å, –∫–≥</div></div>
      <div class="stat"><div class="stat-val" id="t-target">‚Äî</div><div class="stat-label">–¶–µ–ª—å, –∫–≥</div></div>
      <div class="stat"><div class="stat-val" id="t-lost">0</div><div class="stat-label" id="stat-delta-label">–°–±—Ä–æ—à–µ–Ω–æ, –∫–≥</div></div>
    </div>

    <div class="progress-card">
      <div class="progress-header">
        <div class="progress-title">–ü—Ä–æ–≥—Ä–µ—Å—Å</div>
        <div class="progress-text" id="progress-text">0 –∏–∑ ‚Äî –∫–≥</div>
      </div>
      <div class="bar-track"><div class="bar-fill" id="bar"></div></div>
      <div class="milestones">
        <span id="m-start">‚Äî</span>
        <span id="m-mid">‚Äî</span>
        <span id="m-end">‚Äî</span>
      </div>
      <div class="weight-input-row">
        <input type="number" id="weight-log" placeholder="–í–≤–µ–¥–∏ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –≤–µ—Å (–∫–≥)" step="0.1" min="40" max="250">
        <button class="btn" onclick="logWeight()">–ó–∞–ø–∏—Å–∞—Ç—å</button>
      </div>
    </div>

    <div class="section">
      <div class="section-header"><div class="section-icon green-bg">üìä</div><div class="section-title">–¢–≤–æ–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</div></div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div style="background:#111; border-radius:10px; padding:14px; text-align:center;">
          <div style="font-family:'Unbounded',sans-serif; font-size:18px; color:var(--accent)" id="i-bmi">‚Äî</div>
          <div style="font-size:11px; color:var(--muted); margin-top:4px;">–ò–ú–¢</div>
          <div id="i-bmi-label" class="bmi-badge bmi-over" style="margin-top:6px;">‚Äî</div>
        </div>
        <div style="background:#111; border-radius:10px; padding:14px; text-align:center;">
          <div style="font-family:'Unbounded',sans-serif; font-size:18px; color:var(--accent2)" id="i-tdee">‚Äî</div>
          <div style="font-size:11px; color:var(--muted); margin-top:4px;">TDEE (—Ä–∞—Å—Ö–æ–¥ –∫–∫–∞–ª)</div>
        </div>
        <div style="background:#111; border-radius:10px; padding:14px; text-align:center;">
          <div style="font-family:'Unbounded',sans-serif; font-size:18px; color:var(--accent)" id="i-kcal">‚Äî</div>
          <div style="font-size:11px; color:var(--muted); margin-top:4px;" id="kcal-label">–∫–∫–∞–ª/–¥–µ–Ω—å (–ø–ª–∞–Ω)</div>
        </div>
        <div style="background:#111; border-radius:10px; padding:14px; text-align:center;">
          <div style="font-family:'Unbounded',sans-serif; font-size:18px; color:#f5a442" id="i-months">‚Äî</div>
          <div style="font-size:11px; color:var(--muted); margin-top:4px;">–º–µ—Å—è—Ü–µ–≤ –¥–æ —Ü–µ–ª–∏</div>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-header"><div class="section-icon green-bg">üìÖ</div><div class="section-title">–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞</div></div>
      <div class="timeline" id="timeline"></div>
    </div>
  </div>

  <!-- FOOD -->
  <div id="tab-food" class="tab-content">
    <div class="budget-banner">
      <span style="font-size:24px">üí∞</span>
      <div id="food-banner-text"><strong id="food-banner-kcal">~2 500 ‚Ç∏/–¥–µ–Ω—å</strong><br><span style="font-size:12px; color:var(--muted)" id="food-banner-sub">–ê—Å—Ç–∞–Ω–∞ ‚Äî –ú–∞–≥–Ω—É–º / Small / –ê—Ä–∑–∞–Ω</span></div>
    </div>
    <div class="macro-row" id="macro-row"></div>
    <div class="day-selector">
      <button class="day-btn active" onclick="switchDay(0,this)">–ü–ù</button>
      <button class="day-btn" onclick="switchDay(1,this)">–í–¢</button>
      <button class="day-btn" onclick="switchDay(2,this)">–°–†</button>
      <button class="day-btn" onclick="switchDay(3,this)">–ß–¢</button>
      <button class="day-btn" onclick="switchDay(4,this)">–ü–¢</button>
      <button class="day-btn" onclick="switchDay(5,this)">–°–ë</button>
      <button class="day-btn" onclick="switchDay(6,this)">–í–°</button>
    </div>
    <div id="meal-plan"></div>
  </div>

  <!-- GROCERY -->
  <div id="tab-grocery" class="tab-content">
    <div class="section">
      <div class="section-header"><div class="section-icon teal-bg">üõí</div><div class="section-title">–°–ø–∏—Å–æ–∫ –Ω–∞ –Ω–µ–¥–µ–ª—é ‚Äî –ê—Å—Ç–∞–Ω–∞</div></div>
      <div id="grocery-content"><!-- rendered by JS --></div>
    </div>
  </div>

  <!-- WORKOUT -->
  <div id="tab-workout" class="tab-content">
    <div class="section" style="margin-bottom:20px; padding:16px 20px;">
      <div style="font-size:13px; color:var(--muted); line-height:1.6;">
        <strong style="color:var(--text)">–°—Ö–µ–º–∞:</strong> 3 —Å–∏–ª–æ–≤—ã—Ö + 2 –∫–∞—Ä–¥–∏–æ –≤ –Ω–µ–¥–µ–ª—é. –ü–µ—Ä–≤—ã–µ 4 –Ω–µ–¥–µ–ª–∏ ‚Äî –ª—ë–≥–∫–∏–π —Ä–µ–∂–∏–º. –ù–∞–∂–∏–º–∞–π –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —á—Ç–æ–±—ã –æ—Ç–º–µ—á–∞—Ç—å.
      </div>
    </div>
    <div id="workout-plan"></div>
  </div>

  <!-- RULES -->
  <div id="tab-rules" class="tab-content">
    <div class="section">
      <div class="section-header"><div class="section-icon green-bg">‚úÖ</div><div class="section-title">–ß–µ–∫–ª–∏—Å—Ç –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å</div></div>
      <ul class="checklist" id="daily-checklist"></ul>
    </div>
    <div class="section">
      <div class="section-header"><div class="section-icon red-bg">üö´</div><div class="section-title">–ù–µ –¥–µ–ª–∞–π —ç—Ç–æ–≥–æ</div></div>
      <ul class="checklist">
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–ì–æ–ª–æ–¥–æ–≤–∫–∏ –∏ –∂—ë—Å—Ç–∫–∏–µ –¥–∏–µ—Ç—ã</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–ü–∞–Ω–∏–∫–æ–≤–∞—Ç—å –æ—Ç +1 –∫–≥ (—ç—Ç–æ –≤–æ–¥–∞)</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–¢–æ–ª—å–∫–æ –∫–∞—Ä–¥–∏–æ –±–µ–∑ —Å–∏–ª–æ–≤—ã—Ö</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–ü–∏—Ç—å —Å–æ–∫–∏, –≥–∞–∑–∏—Ä–æ–≤–∫—É, –∞–ª–∫–æ–≥–æ–ª—å</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–ñ–¥–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞</span></li>
      </ul>
    </div>
    <div class="section">
      <div class="section-header"><div class="section-icon teal-bg">üí°</div><div class="section-title">–ü—Ä–∏–Ω—Ü–∏–ø—ã</div></div>
      <ul class="checklist">
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–î–µ—Ñ–∏—Ü–∏—Ç ~400‚Äì500 –∫–∫–∞–ª/–¥–µ–Ω—å ‚Äî —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–í—ã—Å–æ–∫–∏–π –±–µ–ª–æ–∫ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º—ã—à—Ü—ã –ø—Ä–∏ –ø–æ—Ö—É–¥–µ–Ω–∏–∏</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–ü–ª–∞—Ç–æ ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –ø—Ä–æ—Å—Ç–æ –¥–µ—Ä–∂–∏ –∫—É—Ä—Å</span></li>
        <li onclick="toggle(this)"><div class="check-circle"></div><span>–°–æ–Ω 7‚Äì8 —á–∞—Å–æ–≤ ‚Äî —á–∞—Å—Ç—å –ø–ª–∞–Ω–∞, –Ω–µ –æ–ø—Ü–∏—è</span></li>
      </ul>
    </div>
  </div>

</div>
</div><!-- /container -->

<script>
// ===== USER DATA =====
let U = {};

// ===== SETUP PREVIEW =====
function calcPreview() {
  const gender = document.getElementById('s-gender').value;
  const age    = parseFloat(document.getElementById('s-age').value) || 0;
  const height = parseFloat(document.getElementById('s-height').value) || 0;
  const weight = parseFloat(document.getElementById('s-weight').value) || 0;
  const target = parseFloat(document.getElementById('s-target').value) || 0;
  const activity = parseFloat(document.getElementById('s-activity').value) || 1.2;

  if (!age || !height || !weight || !target) return;

  const bmr = gender === 'm'
    ? 10 * weight + 6.25 * height - 5 * age + 5
    : 10 * weight + 6.25 * height - 5 * age - 161;

  const tdee   = Math.round(bmr * activity);
  const isGain = target > weight;
  const diff   = Math.abs(weight - target);
  const kcalP  = isGain ? Math.round(tdee + 400) : Math.max(1400, tdee - 450);
  const kcal   = kcalP;
  const months = isGain ? Math.ceil(diff / 1.5) : Math.ceil(diff / 2);
  const protein= Math.round(weight * 1.6);
  const bmi    = (weight / ((height/100) ** 2)).toFixed(1);

  document.getElementById('p-bmi').textContent    = bmi;
  document.getElementById('p-diff').textContent   = diff.toFixed(1) + ' –∫–≥';
  document.getElementById('p-diff-label').textContent = isGain ? '–ù–∞–±—Ä–∞—Ç—å –∫–≥' : '–°–±—Ä–æ—Å–∏—Ç—å –∫–≥';
  document.getElementById('p-kcal').textContent   = kcal + ' –∫–∫–∞–ª';
  document.getElementById('p-months').textContent = months + ' –º–µ—Å';
  document.getElementById('p-protein').textContent= protein + '–≥';
  document.getElementById('p-tdee').textContent   = tdee + ' –∫–∫–∞–ª';
}

// ===== START =====
function startPlan() {
  U.gender   = document.getElementById('s-gender').value;
  U.age      = parseFloat(document.getElementById('s-age').value);
  U.height   = parseFloat(document.getElementById('s-height').value);
  U.weight   = parseFloat(document.getElementById('s-weight').value);
  U.target   = parseFloat(document.getElementById('s-target').value);
  U.activity = parseFloat(document.getElementById('s-activity').value);

  if (!U.age || !U.height || !U.weight || !U.target) { alert('–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!'); return; }
  if (U.target === U.weight) { alert('–ñ–µ–ª–∞–µ–º—ã–π –∏ —Ç–µ–∫—É—â–∏–π –≤–µ—Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ ‚Äî –∏–∑–º–µ–Ω–∏ —Ü–µ–ª—å'); return; }

  const bmr = U.gender === 'm'
    ? 10 * U.weight + 6.25 * U.height - 5 * U.age + 5
    : 10 * U.weight + 6.25 * U.height - 5 * U.age - 161;

  U.tdee    = Math.round(bmr * U.activity);
  U.gain    = U.target > U.weight; // true = bulking, false = cutting
  U.kcal    = U.gain
    ? Math.round(U.tdee + 400)           // surplus ~400 kcal
    : Math.max(1400, U.tdee - 450);      // deficit ~450 kcal
  U.diff    = Math.abs(+(U.weight - U.target).toFixed(1));
  U.months  = U.gain
    ? Math.ceil(U.diff / 1.5)            // gaining ~1.5 kg/month
    : Math.ceil(U.diff / 2);             // losing ~2 kg/month
  U.protein = U.gain
    ? Math.round(U.weight * 2.0)         // more protein for muscle
    : Math.round(U.weight * 1.6);
  U.carbs   = Math.round((U.kcal * (U.gain ? 0.45 : 0.40)) / 4);
  U.fat     = Math.round((U.kcal * 0.25) / 9);
  U.bmi     = (U.weight / ((U.height/100) ** 2)).toFixed(1);
  U.current = U.weight;

  buildMainScreen();
  document.getElementById('setup-screen').style.display = 'none';
  document.getElementById('main-screen').style.display = 'block';
}

function goBack() {
  document.getElementById('setup-screen').style.display = 'block';
  document.getElementById('main-screen').style.display = 'none';
}

// ===== BUILD MAIN =====
function buildMainScreen() {
  // title
  document.getElementById('main-title').innerHTML = `${U.gain ? '–ü–ª—é—Å' : '–ú–∏–Ω—É—Å'} <span style="color:var(--accent)">${U.diff} –∫–≥</span> –∑–∞ ${U.months} –º–µ—Å.`;

  // tracker stats
  document.getElementById('t-current').textContent = U.weight;
  document.getElementById('stat-delta-label').textContent = U.gain ? '–ù–∞–±—Ä–∞–Ω–æ, –∫–≥' : '–°–±—Ä–æ—à–µ–Ω–æ, –∫–≥';
  document.getElementById('t-target').textContent  = U.target;
  document.getElementById('t-lost').textContent    = '0';
  document.getElementById('progress-text').textContent = `0 –∏–∑ ${U.diff} –∫–≥`;
  document.getElementById('m-start').textContent   = U.weight + ' –∫–≥';
  document.getElementById('m-mid').textContent     = Math.round((U.weight + U.target)/2) + ' –∫–≥';
  document.getElementById('m-end').textContent     = U.target + ' –∫–≥';
  setTimeout(() => document.getElementById('bar').style.width = '0%', 100);

  // indicators
  document.getElementById('i-bmi').textContent   = U.bmi;
  document.getElementById('i-tdee').textContent  = U.tdee + ' –∫–∫–∞–ª';
  document.getElementById('i-kcal').textContent  = U.kcal + ' –∫–∫–∞–ª';
  document.getElementById('i-months').textContent= U.months;
  document.getElementById('kcal-label').textContent = U.gain ? '–∫–∫–∞–ª/–¥–µ–Ω—å (–ø—Ä–æ—Ñ–∏—Ü–∏—Ç)' : '–∫–∫–∞–ª/–¥–µ–Ω—å (–¥–µ—Ñ–∏—Ü–∏—Ç)';

  const bmiVal = parseFloat(U.bmi);
  U.gain_label = U.gain ? ' ¬∑ –Ω–∞–±–æ—Ä' : ' ¬∑ –ø–æ—Ö—É–¥–µ–Ω–∏–µ';
  const bmiEl  = document.getElementById('i-bmi-label');
  if (bmiVal < 25)      { bmiEl.className='bmi-badge bmi-normal'; bmiEl.textContent='–ù–æ—Ä–º–∞'; }
  else if (bmiVal < 30) { bmiEl.className='bmi-badge bmi-over';   bmiEl.textContent='–ò–∑–±—ã—Ç–æ–∫'; }
  else                  { bmiEl.className='bmi-badge bmi-obese';  bmiEl.textContent='–û–∂–∏—Ä–µ–Ω–∏–µ'; }

  // timeline
  buildTimeline();

  // macros
  document.getElementById('macro-row').innerHTML = `
    <div class="macro-pill"><div class="macro-val c-protein">${U.protein}–≥</div><div class="macro-label">–ë–µ–ª–æ–∫</div></div>
    <div class="macro-pill"><div class="macro-val c-carbs">${U.carbs}–≥</div><div class="macro-label">–£–≥–ª–µ–≤–æ–¥—ã</div></div>
    <div class="macro-pill"><div class="macro-val c-fat">${U.fat}–≥</div><div class="macro-label">–ñ–∏—Ä—ã</div></div>
    <div class="macro-pill"><div class="macro-val" style="color:var(--text)">${U.kcal}</div><div class="macro-label">–∫–∫–∞–ª</div></div>
  `;

  document.getElementById('food-banner-kcal').textContent = U.gain ? '–ü—Ä–æ—Ñ–∏—Ü–∏—Ç +400 –∫–∫–∞–ª ¬∑ ' + U.kcal + ' –∫–∫–∞–ª/–¥–µ–Ω—å' : '–î–µ—Ñ–∏—Ü–∏—Ç ‚àí450 –∫–∫–∞–ª ¬∑ ' + U.kcal + ' –∫–∫–∞–ª/–¥–µ–Ω—å';
  document.getElementById('food-banner-sub').textContent = U.gain ? '–¶–µ–ª—å ‚Äî –Ω–∞–±–æ—Ä –º—ã—à–µ—á–Ω–æ–π –º–∞—Å—Å—ã' : '–ê—Å—Ç–∞–Ω–∞ ‚Äî –ú–∞–≥–Ω—É–º / Small / –ê—Ä–∑–∞–Ω';
  // checklist
  const dailyKcalText = `–ö–∞–ª–æ—Ä–∏–∏: ${U.kcal} –∫–∫–∞–ª/–¥–µ–Ω—å (${U.gain ? '–ø—Ä–æ—Ñ–∏—Ü–∏—Ç +400' : '–¥–µ—Ñ–∏—Ü–∏—Ç ‚àí450'} –æ—Ç –Ω–æ—Ä–º—ã)`;
  const proteinText   = `–ë–µ–ª–æ–∫: ${U.protein} –≥/–¥–µ–Ω—å`;
  document.getElementById('daily-checklist').innerHTML = [
    dailyKcalText, proteinText, '–í–æ–¥–∞ 2.5‚Äì3 –ª–∏—Ç—Ä–∞', '10 000 —à–∞–≥–æ–≤',
    '–ù–µ –µ—Å—Ç—å –∑–∞ 2‚Äì3 —á–∞—Å–∞ –¥–æ —Å–Ω–∞', '–í–∑–≤–µ—Å–∏–ª—Å—è —É—Ç—Ä–æ–º –Ω–∞—Ç–æ—â–∞–∫'
  ].map(t => `<li onclick="toggle(this)"><div class="check-circle"></div><span>${t}</span></li>`).join('');

  renderMeals(0);
  renderWorkout();
  renderGrocery();
}

// ===== TIMELINE =====
function buildTimeline() {
  let w = U.weight;
  let html = '';
  const steps = Math.min(U.months, 12);
  for (let i = 0; i < steps; i += 2) {
    const mStart = i + 1, mEnd = Math.min(i + 2, U.months);
    const perMonthDir = U.gain ? 1.5 : 2;
    const wEnd = U.gain
      ? Math.min(U.target, +(w + perMonthDir * (mEnd - mStart + 1)).toFixed(1))
      : Math.max(U.target, +(w - perMonthDir * (mEnd - mStart + 1)).toFixed(1));
    const isFirst = i === 0;
    let note = i === 0 ? (U.gain ? '–ù–∞—á–∞–ª–æ ‚Äî –ø–∏—Ç–∞–Ω–∏–µ + —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏' : '–ü—Ä–∏–≤—ã—á–∫–∏, —Ä–µ–∂–∏–º') : i <= 4 ? '–¢–µ–ª–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è, –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–¥—ë—Ç' : i <= 6 ? (U.gain ? '–ù–∞–±–æ—Ä –∏–¥—ë—Ç, –¥–µ—Ä–∂–∏ –ø—Ä–æ—Ñ–∏—Ü–∏—Ç' : '–í–æ–∑–º–æ–∂–Ω–æ –ø–ª–∞—Ç–æ ‚Äî –¥–µ—Ä–∂–∏ –∫—É—Ä—Å') : '–§–∏–Ω–∏—à–Ω–∞—è –ø—Ä—è–º–∞—è';
    const atGoal = U.gain ? wEnd >= U.target : wEnd <= U.target;
    if (atGoal) note = '–§–∏–Ω–∏—à–Ω–∞—è –ø—Ä—è–º–∞—è üéØ';
    html += `<div class="tl-item">
      <div class="tl-dot ${isFirst ? 'active' : ''}"></div>
      <div>
        <div class="tl-month">–ú–µ—Å—è—Ü ${mStart}${mEnd > mStart ? '‚Äì' + mEnd : ''}</div>
        <div class="tl-goal">${w} ‚Üí ${wEnd} –∫–≥</div>
        <div class="tl-note">${note}</div>
      </div>
    </div>`;
    w = wEnd;
    if (atGoal) break;
  }
  document.getElementById('timeline').innerHTML = html;
}

// ===== WEIGHT LOG =====
function logWeight() {
  const val = parseFloat(document.getElementById('weight-log').value);
  if (!val || val < 40 || val > 250) return;
  U.current = val;
  const delta = U.gain
    ? Math.max(0, val - U.weight)
    : Math.max(0, U.weight - val);
  const pct  = Math.min(100, (delta / U.diff) * 100);
  document.getElementById('bar').style.width = pct + '%';
  document.getElementById('progress-text').textContent = delta.toFixed(1) + ' –∏–∑ ' + U.diff + ' –∫–≥';
  document.getElementById('t-current').textContent = val.toFixed(1);
  document.getElementById('t-lost').textContent    = delta.toFixed(1);
}

// ===== MEALS =====
const mealTemplates = [
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 490, items: [['–û–≤—Å—è–Ω–∫–∞ –Ω–∞ –≤–æ–¥–µ','80–≥'],['–Ø–π—Ü–∞ –≤–∞—Ä—ë–Ω—ã–µ','3 —à—Ç'],['–ë–∞–Ω–∞–Ω','1 —à—Ç']] },
    { name: '–û–±–µ–¥',     base: 620, items: [['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ (–±–µ–∑ –∫–æ–∂–∏)','200–≥'],['–ì—Ä–µ—á–∫–∞','200–≥'],['–ö–∞–ø—É—Å—Ç–Ω—ã–π —Å–∞–ª–∞—Ç','200–≥']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 200, items: [['–¢–≤–æ—Ä–æ–≥ 5%','150–≥'],['–Ø–±–ª–æ–∫–æ','1 —à—Ç']] },
    { name: '–£–∂–∏–Ω',     base: 580, items: [['–°–∫—É–º–±—Ä–∏—è –∑–∞–ø–µ—á—ë–Ω–Ω–∞—è','200–≥'],['–ö–∞—Ä—Ç–æ—à–∫–∞ –≤–∞—Ä—ë–Ω–∞—è','150–≥'],['–û–≥—É—Ä–µ—Ü + –ø–æ–º–∏–¥–æ—Ä','150–≥']] },
  ],
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 470, items: [['–û–º–ª–µ—Ç','3 —è–π—Ü–∞'],['–ú–æ–ª–æ–∫–æ','100–º–ª'],['–•–ª–µ–± —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π','1 –ª–æ–º—Ç–∏–∫']] },
    { name: '–û–±–µ–¥',     base: 630, items: [['–ö—É—Ä–∏–Ω—ã–π —Å—É–ø —Å –≥—Ä–µ—á–∫–æ–π','400–º–ª'],['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ','150–≥']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 190, items: [['–¢–≤–æ—Ä–æ–≥','150–≥'],['–ë–∞–Ω–∞–Ω','¬Ω —à—Ç']] },
    { name: '–£–∂–∏–Ω',     base: 570, items: [['–Ø–π—Ü–∞ –≤–∞—Ä—ë–Ω—ã–µ','3 —à—Ç'],['–†–∏—Å','150–≥'],['–ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ –æ–≤–æ—â–∏ –∂–∞—Ä–µ–Ω—ã–µ','200–≥']] },
  ],
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 500, items: [['–û–≤—Å—è–Ω–∫–∞','80–≥'],['–Ø–π—Ü–æ –≤–∞—Ä—ë–Ω–æ–µ','2 —à—Ç'],['–Ø–±–ª–æ–∫–æ','1 —à—Ç']] },
    { name: '–û–±–µ–¥',     base: 640, items: [['–°–∫—É–º–±—Ä–∏—è —Ç—É—à—ë–Ω–∞—è —Å –ª—É–∫–æ–º','200–≥'],['–ì—Ä–µ—á–∫–∞','200–≥'],['–ú–æ—Ä–∫–æ–≤–Ω—ã–π —Å–∞–ª–∞—Ç','150–≥']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 180, items: [['–¢–≤–æ—Ä–æ–≥','100–≥'],['–ú–æ–ª–æ–∫–æ','200–º–ª']] },
    { name: '–£–∂–∏–Ω',     base: 560, items: [['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ –∑–∞–ø–µ—á—ë–Ω–Ω–æ–µ','200–≥'],['–ö–∞–ø—É—Å—Ç–∞ —Ç—É—à—ë–Ω–∞—è','250–≥']] },
  ],
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 510, items: [['–Ø–∏—á–Ω–∏—Ü–∞','3 —è–π—Ü–∞'],['–•–ª–µ–± —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π','2 –ª–æ–º—Ç–∏–∫–∞'],['–ü–æ–º–∏–¥–æ—Ä','1 —à—Ç']] },
    { name: '–û–±–µ–¥',     base: 610, items: [['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ','200–≥'],['–†–∏—Å','150–≥'],['–û–≥—É—Ä–µ—Ü + –∫–∞–ø—É—Å—Ç–∞','200–≥']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 200, items: [['–¢–≤–æ—Ä–æ–≥','150–≥'],['–ë–∞–Ω–∞–Ω','1 —à—Ç']] },
    { name: '–£–∂–∏–Ω',     base: 540, items: [['–°–∫—É–º–±—Ä–∏—è –∑–∞–ø–µ—á—ë–Ω–Ω–∞—è','200–≥'],['–ì—Ä–µ—á–∫–∞','150–≥'],['–ó–µ–ª–µ–Ω—å','‚Äî']] },
  ],
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 480, items: [['–û–≤—Å—è–Ω–∫–∞','80–≥'],['–Ø–π—Ü–æ –≤–∞—Ä—ë–Ω–æ–µ','2 —à—Ç'],['–ú–æ–ª–æ–∫–æ','150–º–ª']] },
    { name: '–û–±–µ–¥',     base: 650, items: [['–ö—É—Ä–∏–Ω—ã–π —Å—É–ø','400–º–ª'],['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ','150–≥'],['–•–ª–µ–±','1 –ª–æ–º—Ç–∏–∫']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 180, items: [['–Ø–π—Ü–∞ –≤–∞—Ä—ë–Ω—ã–µ','2 —à—Ç'],['–û–≥—É—Ä–µ—Ü','1 —à—Ç']] },
    { name: '–£–∂–∏–Ω',     base: 570, items: [['–°–∫—É–º–±—Ä–∏—è –∂–∞—Ä–µ–Ω–∞—è','200–≥'],['–ö–∞—Ä—Ç–æ—à–∫–∞','150–≥'],['–ö–∞–ø—É—Å—Ç–Ω—ã–π —Å–∞–ª–∞—Ç','150–≥']] },
  ],
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 520, items: [['–û–º–ª–µ—Ç —Å –æ–≤–æ—â–∞–º–∏','3 —è–π—Ü–∞'],['–ü–æ–º–∏–¥–æ—Ä + –æ–≥—É—Ä–µ—Ü','150–≥'],['–•–ª–µ–±','1 –ª–æ–º—Ç–∏–∫']] },
    { name: '–û–±–µ–¥',     base: 660, items: [['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ —Ç—É—à—ë–Ω–æ–µ','250–≥'],['–ì—Ä–µ—á–∫–∞','200–≥'],['–õ—É–∫ + –º–æ—Ä–∫–æ–≤—å','100–≥']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 190, items: [['–¢–≤–æ—Ä–æ–≥','150–≥'],['–Ø–±–ª–æ–∫–æ','1 —à—Ç']] },
    { name: '–£–∂–∏–Ω',     base: 520, items: [['–°–∫—É–º–±—Ä–∏—è','200–≥'],['–ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ –æ–≤–æ—â–∏','200–≥']] },
  ],
  [
    { name: '–ó–∞–≤—Ç—Ä–∞–∫',  base: 490, items: [['–¢–≤–æ—Ä–æ–∂–Ω–∞—è –∑–∞–ø–µ–∫–∞–Ω–∫–∞ (—Ç–≤–æ—Ä–æ–≥+—è–π—Ü–∞)','250–≥'],['–ë–∞–Ω–∞–Ω','1 —à—Ç']] },
    { name: '–û–±–µ–¥',     base: 630, items: [['–ö—É—Ä–∏–Ω–æ–µ –±—ë–¥—Ä–æ','200–≥'],['–†–∏—Å','150–≥'],['–°–∞–ª–∞—Ç –∏–∑ –∫–∞–ø—É—Å—Ç—ã –∏ –º–æ—Ä–∫–æ–≤–∏','200–≥']] },
    { name: '–ü–µ—Ä–µ–∫—É—Å',  base: 200, items: [['–Ø–π—Ü–∞ –≤–∞—Ä—ë–Ω—ã–µ','3 —à—Ç'],['–û–≥—É—Ä–µ—Ü','1 —à—Ç']] },
    { name: '–£–∂–∏–Ω',     base: 540, items: [['–°–∫—É–º–±—Ä–∏—è —Ç—É—à—ë–Ω–∞—è','200–≥'],['–ì—Ä–µ—á–∫–∞','150–≥'],['–ó–µ–ª–µ–Ω—å','‚Äî']] },
  ],
];

// Base day costs at 1890 kcal reference
const baseDayCosts = [2600, 2500, 2550, 2600, 2450, 2800, 2700];
function getDayCost(dayIdx) {
  const ratio = U.kcal / 1890;
  return Math.round(baseDayCosts[dayIdx] * ratio / 100) * 100;
}

function scaledKcal(base) {
  // Scale meals proportionally to user's target kcal vs template total (~1890)
  const templateTotal = 1890;
  return Math.round(base * (U.kcal / templateTotal));
}

function renderMeals(dayIdx) {
  const day = mealTemplates[dayIdx];
  const total = day.reduce((s, m) => s + scaledKcal(m.base), 0);
  let html = '';
  day.forEach(m => {
    html += `<div class="meal-card">
      <div class="meal-header">
        <div class="meal-name">${m.name}</div>
        <div class="meal-kcal">${scaledKcal(m.base)} –∫–∫–∞–ª</div>
      </div>
      <div class="meal-items">
        ${m.items.map(i => `<div class="meal-item"><span>${i[0]}</span><span class="meal-item-grams">${i[1]}</span></div>`).join('')}
      </div>
    </div>`;
  });
  html += `<div class="daily-total"><span class="daily-total-label">–ò—Ç–æ–≥–æ –∫–∞–ª–æ—Ä–∏–π</span><span class="daily-total-val">${total} –∫–∫–∞–ª</span></div>`;
  html += `<div class="daily-cost"><span class="daily-cost-label">üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–Ω—è</span><span class="daily-cost-val">~${getDayCost(dayIdx).toLocaleString()} ‚Ç∏</span></div>`;
  document.getElementById('meal-plan').innerHTML = html;
}

function switchDay(idx, btn) {
  document.querySelectorAll('.day-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  renderMeals(idx);
}


// ===== GROCERY =====
function renderGrocery() {
  const r = U.kcal / 1890; // scale ratio
  const fmt = n => '~' + Math.round(n * r / 100) * 100 + ' ‚Ç∏';
  const fmtFixed = n => '~' + n + ' ‚Ç∏'; // for fixed items (veggies etc)

  // Quantities scale with calories
  const chickenKg  = Math.max(1, (1.4 * r)).toFixed(1);
  const eggs       = Math.round(21 * r);
  const mackerelKg = Math.max(0.8, (1.1 * r)).toFixed(1);
  const tvorogKg   = Math.max(0.5, (0.9 * r)).toFixed(1);
  const milkL      = Math.max(1, Math.round(2 * r));
  const buckwheatKg= Math.max(0.5, (0.7 * r)).toFixed(1);
  const oatKg      = Math.max(0.5, (0.7 * r)).toFixed(1);
  const riceKg     = Math.max(0.5, (0.6 * r)).toFixed(1);
  const potatoKg   = Math.max(1, Math.round(2 * r));
  const breadPcs   = Math.max(1, Math.round(2 * r));

  // Prices per unit (Astana, tenge)
  const chickenPrice  = Math.round(1400 * parseFloat(chickenKg));
  const eggsPrice     = Math.round(eggs * 60);
  const mackerelPrice = Math.round(1000 * parseFloat(mackerelKg));
  const tvorogPrice   = Math.round(1400 * parseFloat(tvorogKg));
  const milkPrice     = Math.round(350 * milkL);
  const buckwPrice    = Math.round(500 * parseFloat(buckwheatKg));
  const oatPrice      = Math.round(400 * parseFloat(oatKg));
  const ricePrice     = Math.round(450 * parseFloat(riceKg));
  const potatoPrice   = Math.round(150 * potatoKg);
  const breadPrice    = Math.round(300 * breadPcs);

  // Fixed items
  const fixedTotal = 150+200+500+600+300+700+500+400+700+400+300;

  const varTotal = chickenPrice+eggsPrice+mackerelPrice+tvorogPrice+milkPrice+
                   buckwPrice+oatPrice+ricePrice+potatoPrice+breadPrice;
  const grandTotal = varTotal + fixedTotal;
  const dayAvg = Math.round(grandTotal / 7 / 100) * 100;

  const items = (list) => list.map(([name, qty, price]) =>
    `<div class="grocery-item"><span>${name} ‚Äî ${qty}</span><span class="grocery-price">~${price.toLocaleString()} ‚Ç∏</span></div>`
  ).join('');

  document.getElementById('grocery-content').innerHTML = `
    <div class="grocery-section">
      <div class="grocery-title">ü•© –ë–µ–ª–æ–∫</div>
      ${items([
        ['–ö—É—Ä–∏–Ω—ã–µ –±—ë–¥—Ä–∞', chickenKg+' –∫–≥', chickenPrice],
        ['–Ø–π—Ü–∞', eggs+' —à—Ç', eggsPrice],
        ['–°–∫—É–º–±—Ä–∏—è –º–æ—Ä–æ–∂–µ–Ω–∞—è', mackerelKg+' –∫–≥', mackerelPrice],
        ['–¢–≤–æ—Ä–æ–≥ 5‚Äì9%', tvorogKg+' –∫–≥', tvorogPrice],
        ['–ú–æ–ª–æ–∫–æ 2.5%', milkL+' –ª', milkPrice],
      ])}
    </div>
    <div class="grocery-section">
      <div class="grocery-title">üåæ –ö—Ä—É–ø—ã</div>
      ${items([
        ['–ì—Ä–µ—á–∫–∞', buckwheatKg+' –∫–≥', buckwPrice],
        ['–û–≤—Å—è–Ω–∫–∞', oatKg+' –∫–≥', oatPrice],
        ['–†–∏—Å', riceKg+' –∫–≥', ricePrice],
        ['–ö–∞—Ä—Ç–æ—à–∫–∞', potatoKg+' –∫–≥', potatoPrice],
        ['–•–ª–µ–± —Ü–µ–ª—å–Ω–æ–∑–µ—Ä–Ω–æ–≤–æ–π', breadPcs+' —à—Ç', breadPrice],
      ])}
    </div>
    <div class="grocery-section">
      <div class="grocery-title">ü•¶ –û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã <span style="font-size:11px; color:var(--muted); font-family:'Onest',sans-serif; font-weight:400;">(–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ)</span></div>
      ${items([
        ['–ö–∞–ø—É—Å—Ç–∞', '1 –∫–≥', 150],
        ['–ú–æ—Ä–∫–æ–≤—å', '1 –∫–≥', 200],
        ['–û–≥—É—Ä—Ü—ã', '1 –∫–≥', 500],
        ['–ü–æ–º–∏–¥–æ—Ä—ã', '1 –∫–≥', 600],
        ['–õ—É–∫, —á–µ—Å–Ω–æ–∫, –∑–µ–ª–µ–Ω—å', '‚Äî', 300],
        ['–ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ –æ–≤–æ—â–∏', '1 –∫–≥', 700],
        ['–ë–∞–Ω–∞–Ω—ã', '1 –∫–≥', 500],
        ['–Ø–±–ª–æ–∫–∏', '1 –∫–≥', 400],
      ])}
    </div>
    <div class="grocery-section">
      <div class="grocery-title">ü´ô –ü—Ä–æ—á–µ–µ</div>
      ${items([
        ['–ú–∞—Å–ª–æ –ø–æ–¥—Å–æ–ª–Ω–µ—á–Ω–æ–µ', '1 –ª', 700],
        ['–°–æ–µ–≤—ã–π —Å–æ—É—Å', '1 –±—É—Ç.', 400],
        ['–°–æ–ª—å, —Å–ø–µ—Ü–∏–∏', '‚Äî', 300],
      ])}
    </div>
    <div class="grocery-total">
      <span style="font-size:13px; color:var(--muted)">–ó–∞–∫—É–ø–∫–∞ –Ω–∞ –Ω–µ–¥–µ–ª—é</span>
      <span style="font-family:'Unbounded',sans-serif; font-size:16px; color:var(--accent2)">~${grandTotal.toLocaleString()} ‚Ç∏</span>
    </div>
    <div class="daily-cost" style="margin-top:8px;">
      <span class="daily-cost-label">üí∞ –í—ã—Ö–æ–¥–∏—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –≤ –¥–µ–Ω—å</span>
      <span class="daily-cost-val">~${dayAvg.toLocaleString()} ‚Ç∏</span>
    </div>
    <div style="font-size:12px; color:var(--muted); margin-top:12px; line-height:1.7;">
      üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ –ø–æ–¥ —Ç–≤–æ–∏ <strong style="color:var(--text)">${U.kcal} –∫–∫–∞–ª/–¥–µ–Ω—å</strong>. –ß–µ–º –±–æ–ª—å—à–µ –∫–∞–ª–æ—Ä–∞–∂ ‚Äî —Ç–µ–º –±–æ–ª—å—à–µ –ø–æ—Ä—Ü–∏–∏ –∏ –∑–∞–∫—É–ø–∫–∞. –û–≤–æ—â–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ ‚Äî –∏—Ö –æ–±—ä—ë–º –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è.
    </div>
  `;
}

// ===== WORKOUT =====
function getWorkoutPlan() {
  const age    = U.age;
  const gain   = U.gain;
  const gender = U.gender;
  const bmi    = parseFloat(U.bmi);

  // Intensity label based on age
  const isSenior  = age >= 50;
  const isYoung   = age <= 30;

  // Cardio duration: more for fat loss, less for gain; longer for high BMI
  const cardioDur  = gain ? 30 : (bmi >= 35 ? 50 : 40);
  const cardioType = gender === 'f'
    ? (isSenior ? '–°–∫–∞–Ω–¥–∏–Ω–∞–≤—Å–∫–∞—è —Ö–æ–¥—å–±–∞ / –±–∞—Å—Å–µ–π–Ω' : '–≠–ª–ª–∏–ø—Å / –≤–µ–ª–æ—Å–∏–ø–µ–¥ / —Ç–∞–Ω—Ü—ã')
    : (isSenior ? '–ë—ã—Å—Ç—Ä–∞—è —Ö–æ–¥—å–±–∞ / –≤–µ–ª–æ—Å–∏–ø–µ–¥' : '–≠–ª–ª–∏–ø—Å / –±–µ–≥ —Ç—Ä—É—Å—Ü–æ–π');
  const stretching = isSenior ? 25 : 15;

  // Sets/reps logic
  // Loss ‚Üí more reps, less weight; Gain ‚Üí less reps, more weight
  // Senior ‚Üí less intensity, joint-friendly
  const setsH  = gain ? '4' : '3';  // heavy compound sets
  const setsL  = '3';
  const repsH  = gain ? '6‚Äì8' : (isSenior ? '12‚Äì15' : '10‚Äì12');
  const repsM  = gain ? '8‚Äì10' : (isSenior ? '15' : '12');
  const repsHi = isSenior ? '15‚Äì20' : (gain ? '12' : '15‚Äì20');

  // Exercise selection by gender + age + goal
  const squat   = isSenior ? '–ü—Ä–∏—Å–µ–¥ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–Ω–µ–≥–ª—É–±–æ–∫–∏–π)' : '–ü—Ä–∏—Å–µ–¥ —Å–æ —à—Ç–∞–Ω–≥–æ–π';
  const bench   = gender === 'f'
    ? (gain ? '–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞' : '–û—Ç–∂–∏–º–∞–Ω–∏—è / –∂–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π')
    : (isSenior ? '–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π –ª—ë–∂–∞' : '–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞');
  const row     = isSenior ? '–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç—è–≥–∞ —Å–∏–¥—è' : '–¢—è–≥–∞ —à—Ç–∞–Ω–≥–∏ –≤ –Ω–∞–∫–ª–æ–Ω–µ';
  const shoulder = gender === 'f' ? '–ü–æ–¥—ä—ë–º—ã –≥–∞–Ω—Ç–µ–ª–µ–π –≤ —Å—Ç–æ—Ä–æ–Ω—ã' : '–ñ–∏–º –≥–∞–Ω—Ç–µ–ª–µ–π —Å–∏–¥—è';
  const deadlift = isSenior ? '–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏ (–ª—ë–≥–∫–∞—è)' : (gain ? '–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞' : '–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ (–ª—ë–≥–∫–∞—è)');
  const lunge   = gender === 'f' ? '–í—ã–ø–∞–¥—ã —Å –≥–∞–Ω—Ç–µ–ª—è–º–∏' : '–í—ã–ø–∞–¥—ã';
  const rdl     = '–†—É–º—ã–Ω—Å–∫–∞—è —Ç—è–≥–∞';
  const pulldown = '–¢—è–≥–∞ –≤–µ—Ä—Ö–Ω–µ–≥–æ –±–ª–æ–∫–∞';
  const core1   = isSenior ? '–ü–ª–∞–Ω–∫–∞ (–Ω–∞ –ª–æ–∫—Ç—è—Ö)' : '–ü–ª–∞–Ω–∫–∞';
  const core2   = gender === 'f' ? '–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è / –ø–æ–¥—ä—ë–º—ã –Ω–æ–≥' : '–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è';
  const core3   = gender === 'f' ? '–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫' : '–í–µ–ª–æ—Å–∏–ø–µ–¥ (–ø—Ä–µ—Å—Å)';
  const pushup  = gender === 'f' ? '–û—Ç–∂–∏–º–∞–Ω–∏—è (—Å –∫–æ–ª–µ–Ω –∏–ª–∏ –ø–æ–ª–Ω—ã–µ)' : '–û—Ç–∂–∏–º–∞–Ω–∏—è';
  const calf    = '–ü–æ–¥—ä—ë–º—ã –Ω–∞ –Ω–æ—Å–∫–∏';

  // Plank duration
  const plankDur = isSenior ? '30 —Å–µ–∫' : (gain ? '45 —Å–µ–∫' : '45‚Äì60 —Å–µ–∫');

  // Generate note for workout header
  const profileNote = [
    gender === 'f' ? 'üë© –ñ–µ–Ω—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞' : 'üë® –ú—É–∂—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞',
    gain ? 'üí™ –ù–∞–±–æ—Ä –º–∞—Å—Å—ã' : 'üî• –ñ–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏–µ',
    isSenior ? '¬∑ —â–∞–¥—è—â–∏–π —Ä–µ–∂–∏–º (50+)' : isYoung ? '¬∑ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º' : '¬∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º'
  ].join(' ');

  return { profileNote, days: [
    { name: '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ ‚Äî –°–∏–ª–æ–≤–∞—è A (–Ω–∏–∑ —Ç–µ–ª–∞)', type: 'strength', exercises: [
      { name: squat,    sets: `${setsH}√ó${repsH}` },
      { name: rdl,      sets: `${setsH}√ó${repsM}` },
      { name: lunge,    sets: `${setsL}√ó${repsM} –∫–∞–∂–¥–∞—è` },
      { name: calf,     sets: `3√ó${repsHi}` },
      { name: core1,    sets: `3√ó${plankDur}` },
    ]},
    { name: '–í—Ç–æ—Ä–Ω–∏–∫ ‚Äî –ö–∞—Ä–¥–∏–æ', type: 'cardio', exercises: [
      { name: cardioType,           sets: `${cardioDur} –º–∏–Ω` },
      { name: '–ü—É–ª—å—Å 120‚Äì140 —É–¥/–º–∏–Ω', sets: '–∫–æ–Ω—Ç—Ä–æ–ª—å' },
    ]},
    { name: '–°—Ä–µ–¥–∞ ‚Äî –°–∏–ª–æ–≤–∞—è B (–≤–µ—Ä—Ö —Ç–µ–ª–∞)', type: 'strength', exercises: [
      { name: bench,    sets: `${setsH}√ó${repsH}` },
      { name: row,      sets: `${setsH}√ó${repsH}` },
      { name: pulldown, sets: `${setsL}√ó${repsM}` },
      { name: shoulder, sets: `${setsL}√ó${repsHi}` },
      { name: core2,    sets: `3√ó20` },
    ]},
    { name: '–ß–µ—Ç–≤–µ—Ä–≥ ‚Äî –û—Ç–¥—ã—Ö / –ª—ë–≥–∫–∞—è –ø—Ä–æ–≥—É–ª–∫–∞', type: 'rest', exercises: [] },
    { name: '–ü—è—Ç–Ω–∏—Ü–∞ ‚Äî –°–∏–ª–æ–≤–∞—è C (–ø–æ–ª–Ω–æ–µ —Ç–µ–ª–æ)', type: 'strength', exercises: [
      { name: deadlift, sets: `${setsH}√ó${gain ? '5' : repsH}` },
      { name: pushup,   sets: `3√ó–º–∞–∫—Å–∏–º—É–º` },
      { name: pulldown, sets: `${setsL}√ó${repsM}` },
      { name: shoulder, sets: `${setsL}√ó${repsHi}` },
      { name: core3,    sets: `3√ó20` },
    ]},
    { name: '–°—É–±–±–æ—Ç–∞ ‚Äî –ö–∞—Ä–¥–∏–æ + —Ä–∞—Å—Ç—è–∂–∫–∞', type: 'cardio', exercises: [
      { name: cardioType,  sets: `${cardioDur + 10} –º–∏–Ω` },
      { name: '–†–∞—Å—Ç—è–∂–∫–∞',  sets: `${stretching} –º–∏–Ω` },
    ]},
    { name: '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ ‚Äî –û—Ç–¥—ã—Ö', type: 'rest', exercises: [] },
  ]};
}

function renderWorkout() {
  const { profileNote, days } = getWorkoutPlan();
  const header = `<div class="section" style="margin-bottom:16px; padding:14px 18px; background:rgba(200,245,66,0.06); border:1px solid rgba(200,245,66,0.15); border-radius:12px;">
    <div style="font-size:13px; line-height:1.7; color:var(--text)">${profileNote}</div>
    <div style="font-size:12px; color:var(--muted); margin-top:6px;">3 —Å–∏–ª–æ–≤—ã—Ö + 2 –∫–∞—Ä–¥–∏–æ –≤ –Ω–µ–¥–µ–ª—é ¬∑ –Ω–∞–∂–∏–º–∞–π –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —á—Ç–æ–±—ã –æ—Ç–º–µ—á–∞—Ç—å</div>
  </div>`;
  const body = days.map(day => {
    const bc = day.type==='strength' ? 'badge-strength' : day.type==='cardio' ? 'badge-cardio' : 'badge-rest';
    const bt = day.type==='strength' ? '–°–∏–ª–æ–≤–∞—è' : day.type==='cardio' ? '–ö–∞—Ä–¥–∏–æ' : '–û—Ç–¥—ã—Ö';
    return `<div class="workout-day">
      <div class="workout-day-header">
        <div class="workout-day-name">${day.name}</div>
        <span class="workout-badge ${bc}">${bt}</span>
      </div>
      ${day.type==='rest'
        ? `<div class="rest-day"><span>üò¥</span>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî —Ç–æ–∂–µ —á–∞—Å—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</div>`
        : `<div class="exercise-list">${day.exercises.map(ex =>
            `<div class="exercise" onclick="this.classList.toggle('done-ex')">
              <span>${ex.name}</span><span class="ex-sets">${ex.sets}</span>
            </div>`).join('')}</div>`}
    </div>`;
  }).join('');
  document.getElementById('workout-plan').innerHTML = header + body;
}

function switchTab(id) {
  document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
  document.getElementById('tab-' + id).classList.add('active');
  event.target.classList.add('active');
}

function toggle(el) { el.classList.toggle('done'); }

// Init preview
calcPreview();
</script>
</body>
</html>
